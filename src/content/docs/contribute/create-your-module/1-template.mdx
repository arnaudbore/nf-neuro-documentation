---
title: Module initialization
description: Generate your module's template using `nf-core` commands.
---

import { Steps } from '@astrojs/starlight/components';

This page is the first of this tutorial series focusing on the creation of a custom
module meant for `nf-neuro`. For the purpose of this tutorial, we create a module that
denoises T1w images using the **Non-Local Means** (NLM) algorithm's implementation
available in [scilpy](https://github.com/scilus/scilpy) via the script
[`scil_denoising_nlmeans.py`](https://scilpy.readthedocs.io/en/latest/scripts/scil_denoising_nlmeans.html).

## First steps

If not done already, clone the `nf-neuro` repository locally and navigate to it :

```bash
git clone https://github.com/scilus/nf-neuro.git
cd nf-neuro
```

Create a new branch for your module, following the convention `module/<category>_<tool>`
for the branch name (for the current tutorial : `module/denoising_nlmeans`). This will help
you and maintainers keep track of changes made to the module :

```bash
git checkout -b module/denoising_nlmeans
```

### Generate the template

In a **terminal** with access to `nf-core`, use `cd` to locate yourself in the `nf-neuro`
repository. Then, generate a **skeleton** for your module by running the interactive command :

```bash
nf-core modules create
```

Answer the prompts using the information below :

<Steps>
1. **Name of tool/subtool** : `denoising/nlmean`
    - This is the `<category>/<tool>` of the module you plan creating
2. **Bioconda package** : select `no`.
    - Nextflow is able to automatically install dependencies using `conda`, but we haven't
      explored those avenues yet. We welcome any collaboration on this topic, please open an
      issue on the [nf-neuro repository](https://github.com/scilus/nf-neuro/issues). 
      You can refer to the [nf-core documentation](https://nf-co.re/docs/guidelines/components/modules#software-requirements)
      for more information on the matter.
3. **Github author** : your Github handle, or `@scilus` if you prefer no accreditation.
4. **Resource label** : for **denoising/nlmeans**, select `process_medium`, since it can parallelize computations
    - Resource allocation with labels can vary depending on infrastructure and availability.
    - All labels below get allocated around **4Gb** of RAM. For CPU, a rule of thumb is :
        - **process_single** : 1 CPU core
        - **process_low** : 2 CPU cores 
        - **process_medium** : 4 CPU cores
        - **process_high** : 6 CPU cores
5. **Meta map** : select `yes`.
</Steps>

Alternatively, you can use the following command to supply nearly all information :

```bash
nf-core modules create --author @scilus --label process_medium --meta denoising/nlmeans
```

You will still have to interact with the **bioconda** prompt, still select `no`.

:::note
  Once used to the conventions for developping within `nf-neuro`, adding `--empty-template`
  to the command will disable auto-generation of comments, examples and TODOs and
  can be a time-saver.
:::

The command will generate your new module template in the `./modules/nf-neuro/denoising/nlmeans`
directory. Navigate to it and familiarize yourself with the various files generated. After that,
switch to the next section of the tutorial and proceed to edit the `main.nf` file.